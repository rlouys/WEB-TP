{% extends "main.html" %}
{% block body %}
<br>

    <div style="max-width: 90%!important;" class="listePage">
        <h1>Bienvenue dans la bibliothèque d'utilisateurs!</h1>
        <br><br>
        <h4>Ici vous pouvez voir et gérer votre collection de users.</h4>
        <br>

        <div class="header-container">
            <h3>Liste des utilisateurs</h3>
            <h6 id="nombre-livre" class="book-count-container">
                Nombre d'utilisateurs :
                <p class="book-count" >{{length}}</p>
            </h6>
        </div>
        <br>
            <div id="livres-list">
                <div>

                    <table class="table table-responsive-sm table-light table-hover" >
                        <thead>
                            <tr class="table-success">
                                <th scope="col"><i class="fa-solid fa-lg fa-key pr-1"></i> ID</th>
                                <th scope="col"><i class="fa-solid fa-lg fa-user pr-1"></i> Username</th>
                                <th scope="col"><i class="fa-solid fa-lg fa-at pr-1"></i> Adresse e-mail</th>
                                <th scope="col"><i class="fa-solid fa-lg fa-layer-group pr-1"></i> Privileges </th>
                                <th scope="col"><i class="fa-solid fa-lg fa-calendar pr-1"></i> Date d'ajout </th>
                                <th scope="col"><i class="fa-solid fa-lg fa-link pr-1"></i> Bloqué </th>

                                <!-- on gérera ici le fait d'afficher le propriétaire ou pas -->
                                {% if 1 %}
                                {% endif %}

                                <th scope="col"></th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for user in users %}
                                <tr>
                                    <td><strong>{{user.id}}</strong></td>
                                    <td>{{user.username}}</td>
                                    <td>{{user.email}}</td>
                                    <td>{{user.privileges}}</td>
                                    <td>{{user.date_added}}</td>
                                    <td>{{user.is_locked}}</td>
                                    <td>
                                        <!-- BUTTON EDIT -->
                                        <div class="flex items-center">
                                            <button type="button" class="btn btn-light w-10 h-10 p-0 rounded-full" onclick="redirectToModify(null,{{ user.id }})">
                                                <i class="fa-regular fa-pen-to-square fa-xl"></i>
                                            </button>
                                            <!-- BUTTON DELETE -->
                                            <button type="submit" class="btn btn-light w-10 h-10 p-0 rounded-full" onclick="confirmDeletion(null, {{ user.id }})">
                                                <i class="fa-solid fa-trash fa-xl"></i>
                                            </button>
                                        </div>

                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                <br>

                <!-- PAGE NAVIGATION -->
                 <div class="pagination-container">
                            <nav aria-label="Page navigation">
                                <ul class="pagination nav-clue">
                                    {% if page > 3 %}
                                        <li style="z-index: 2;" class="page-item"><a class="page-link" href="/liste?page=1"><i class="fa-solid fa-backward-fast"></i></a></li>
                                    {% endif %}

                                    {% if page > 1 %}
                                        <li style="z-index: 2;" class="page-item"><a class="page-link" href="/liste?page={{ page - 1 }}">Previous</a></li>
                                    {% endif %}

                                    {% set max_displayed_pages = 5 %}
                                    {% set start_page = 1 %}
                                    {% set end_page = total_pages %}
                                    {% if total_pages > max_displayed_pages %}
                                        {% set start_page = (page - (max_displayed_pages // 2)) %}
                                        {% set end_page = (page + (max_displayed_pages // 2)) %}
                                        {% if start_page < 1 %}
                                            {% set start_page = 1 %}
                                            {% set end_page = max_displayed_pages %}
                                        {% elif end_page > total_pages %}
                                            {% set end_page = total_pages %}
                                            {% set start_page = total_pages - max_displayed_pages + 1 %}
                                        {% endif %}
                                    {% endif %}

                                    {% for num in range(start_page, end_page + 1) %}
                                        <li class="page-item {% if num == page %}active{% endif %}">
                                            <a style="z-index: 2;" class="page-link" href="/userlist?page={{ num }}">{{ num }}</a>
                                        </li>
                                    {% endfor %}

                                    {% if end_page < total_pages %}
                                        <li class="page-item disabled"><a class="page-link">...</a></li>
                                        <li class="page-item">
                                            <a style="z-index: 2;" class="page-link" href="/userlist?page={{ total_pages }}">{{ total_pages }}</a>
                                        </li>
                                    {% endif %}

                                    {% if page < total_pages %}
                                        <li style="z-index: 2;" class="page-item"><a class="page-link" href="/userlist?page={{ page + 1 }}">Next</a></li>
                                    {% endif %}
                                </ul>
                            </nav>



                         <p>
                            <a href='/empty_user_keep_admin' id="empty table" class="btn btn-outline-success">Empty Table</a>
                            <a href='/userlist' id="add-random-users" class="btn btn-outline-success">Add Random Users</a>
                            <a href='/ajouter_user' class="btn btn-outline-success">Ajouter un nouvel utilisateur</a>
                        </p>

                        </div>






        </div>
    </div>
</div>



{% endblock %}



